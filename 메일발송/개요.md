# 간이종심제 메일 자동화 – 개요 & 기술선정 (for codex)

## 1) 목표

엑셀(고정 셀 주소)에서 공고정보/업체목록을 **자동 추출**하여 폼에 채우고, 필요 시 **수동 수정** 후 **개인 메일(Naver/Gmail) 계정으로 SMTP 발송**(개별/일괄)한다.

## 2) 핵심 기능

* **엑셀 파싱**: `.xlsx/.xlsm` 로드 → 지정 셀에서 공고정보, 테이블 영역에서 업체 행 반복 추출
* **자동 채움 + 편집**: 읽은 값을 폼/그리드에 바인딩, 사용자가 즉시 수정 가능
* **템플릿 치환**: 제목/본문 템플릿(Handlebars)로 변수 치환(숫자·날짜 포맷 포함)
* **메일 발송**: SMTP(Gmail/Naver)로 개별 전송(기본 지연 적용), 선택적으로 Draft 생성
* **기록(선택)**: SQLite에 발송 결과/메시지ID 저장, 재시도 가능

## 3) 권장 기술 스택

* **Excel 파싱**: SheetJS `xlsx`

  * .xlsx/.xlsm 지원, 셀 주소/병합 처리 용이
* **이메일 발송**: Nodemailer (SMTP)

  * Gmail: `smtp.gmail.com` + 2FA **앱 비밀번호**
  * Naver: `smtp.naver.com` + SMTP/IMAP 사용 설정
* **자격증명 저장**: `keytar` (OS 보안 스토리지)
* **템플릿 엔진**: Handlebars (헬퍼로 `number`, `date`, `currency` 제공)
* **로컬 DB(선택)**: SQLite (`better-sqlite3`) – 발송 로그/재시도
* **UI**: React(현행) + 파일 드래그앤드롭, 폼/그리드 편집

## 4) 최소 플로우

1. 파일 선택/드래그 → SheetJS 파싱 → 매핑 프리셋(JSON)으로 값 추출
2. 폼/그리드 자동 채움 → 사용자가 수동 보정
3. 템플릿 미리보기 → SMTP 프로필 선택(Gmail/Naver)
4. **개별 전송**(기본 1초 간격, 재시도 3회) → 결과 토스트/요약

## 5) 운영 메모

* 공고번호는 문자열로 보존(하이픈·선행 0 유지)
* 엑셀 날짜 시리얼 → Asia/Seoul 기준 시간 변환
* 대량 전송은 개별 발송 + 지연으로 스팸 회피
* Gmail/Naver는 SMTP 발송 메일이 보낸편지함에 저장됨(클라이언트 중복 업로드 비활성 권고)

> 상세 매핑표/와이어프레임/전체 코드 등은 협업 중 확정 예정.
