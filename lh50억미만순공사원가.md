이제 사용자가 입력한 기초금액, 순공사원가, A값을 토대로 순공사원가 가점이 존재하는지 알아야겠지?
존재한다면 가점이 몇점인지도 알아야하니까.

일단 LH50억미만 부터 시작하자

 LH 50억 미만 — 순공사원가 가점 계산 스펙
1) 입력값

Base : 기초금액

NetCost : 순공사원가

A : A값

2) 예정가격(사정율 범위, 천원 미만 절상)

사정율 범위: 0.988 ~ 1.012

천원 단위 올림(천원 미만 절상): ROUNDUP(x, -3) (엑셀 기준)

ExpectedMin = ROUNDUP(Base * 0.988, -3)
ExpectedMax = ROUNDUP(Base * 1.012, -3)

3) 순공사원가 반영금액(= 입찰가격으로 사용)

공식:

Bid = NetCost * (Expected / Base) * 0.98


따라서

BidMin = NetCost * (ExpectedMin / Base) * 0.98
BidMax = NetCost * (ExpectedMax / Base) * 0.98

4) 비율 R
R = (Bid - A) / (Expected - A)


따라서

Rmin = (BidMin - A) / (ExpectedMin - A)
Rmax = (BidMax - A) / (ExpectedMax - A)

5) 입찰가격점수(원식)

중요: 입찰가격점수 자체(70점 만점) 는 아래 식:

PriceScore(R) = 70 - 4 * ABS((0.9 - R) * 100)

6) 순공사원가 “가점” 산출 (LH 50억 미만 규칙)

LH 50억 미만은 입찰가격점수에서 65점을 기준으로 초과분만 가점으로 사용한다.

Bonus(R) = PriceScore(R) - 65
FinalBonus = max(0, min(Bonus(Rmin), Bonus(Rmax)))


Bonus가 음수면 가점 없음으로 보고 0 처리

낙찰 전이므로 사정율 2개 경우(최소/최대) 중 더 불리한(작은) 가점을 택함

최종적으로 각 해당하는 점수는

7) 예시(사용자가 준 값)

입력:

Base(기초금액) = 2,717,575,000

NetCost(순공사원가) = 2,453,003,300

A = 159,497,306

예정가격(천원 절상):

MinExpected = 2,684,965,000

MaxExpected = 2,750,186,000

순공사원가 반영금액:

MinBid = 2,375,096,711

MaxBid = 2,432,790,641

R:

Rmin = 0.8773

Rmax = 0.8775

입찰가격점수:

ScoreMin = 68.92

ScoreMax = 69.00

가점(65점 기준 초과분):

BonusMin = 3.92

BonusMax = 4.00

보수적 최종 가점:

FinalBonus = 3.92