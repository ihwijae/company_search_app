# 자동 협정 기능 정리

## 최근 합의 사항 요약
- **운영 방식**: 모든 공고는 하나의 마스터 엑셀 파일에 시트를 계속 추가하는 방식으로 관리.
- **엑셀 파일 잠금**: 가능하면 파일이 열려 있어도 작업하도록 구현하되, 기술적으로 어려우면 "파일을 닫고 다시 시도" 알림을 표시.
- **템플릿/매핑 경로**: 사용자마다 경로가 다를 수 있으므로, 앱 내에서 템플릿/셀 매핑 폴더를 설정할 수 있는 UI 필요.
- **Config(고정 업체 등)**: 개발자가 기본 config를 유지하되, 사용자에겐 Import/Export 기능만 제공하여 새 config 파일만 받아 적용하도록 함.
- **시트 이름 규칙**:
  - 공고명을 축약해 `[포천2공공하수처리시설]` 형태로 사용.
  - 공종이 통신이면 시트명 끝에 `(통신)`을, 소방이면 `(소방)`을 붙이고 탭 색을 각각 짙은 하늘색/짙은 빨간색으로 지정.
  - 같은 이름이 이미 존재하면 `-1`, `-2` 같은 숫자 suffix를 자동으로 붙여 중복을 피함.

## 작업 순서 가이드
1. **사이드바/페이지 뼈대 작성**: 좌측 메뉴에 "협정 자동화" 추가 후 빈 페이지 컴포넌트 구성.
2. **Config/템플릿 스키마 확정**: 템플릿·셀 매핑·고정업체 JSON 구조와 경로 설정 UI 설계.
3. **UI 구축**: PRD의 구역 A~D(입력 폼, 금액 영역, 협정 구성 테이블, 파일 선택/실행)를 순차 구현하고 검증 로직 추가.
4. **자동 구성 로직**: Config를 이용해 기본 협정안을 생성하고 Import/Export 흐름을 구현.
5. **엑셀 처리**: 템플릿 시트를 복사하고 셀 매핑에 따라 값을 입력하며, 시트 이름/색/중복 처리와 실행 로그·검증 모달을 완성.

## 추가 참고
- PRD 요구사항에 따라 실행 전 검증 모달과 실행 로그/결과 표시 기능을 넣어 안전성을 확보.
- Config는 가능한 한 읽기 전용으로 유지하고, 변경이 필요할 때는 JSON 파일을 외부에서 수정 후 Import하도록 안내.
