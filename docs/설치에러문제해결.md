# 설치 에러 문제 해결 가이드

## 상황 요약
- 협정보조.exe가 이미 실행 중이라는 메시지 때문에 새 설치가 차단됨.
- 실제로는 서비스 혹은 자동 실행 항목으로 인해 SYSTEM 권한으로 프로세스가 계속 살아 있어서 일반 종료나 taskkill로도 닫히지 않음.

## 해결 절차
1. **서비스 여부 확인 및 중지**
   - `services.msc`를 열어 이름에 "협정보조"가 들어간 서비스를 찾는다.
   - PowerShell/명령 프롬프트(관리자)에서 `Get-Service | ?{$_.Name -like '*협정보조*'}`로도 조회 가능.
   - 확인되면 `sc stop <서비스명>`으로 중지하고, 필요 시 `sc config <서비스명> start= disabled`로 자동 실행을 막는다.
2. **작업 스케줄러·시작프로그램 점검**
   - 작업 스케줄러(`taskschd.msc`)에서 협정보조.exe를 호출하는 트리거를 비활성화/삭제.
   - 작업 관리자 → 시작프로그램 탭 또는 `msconfig`에서 동일 항목이 있는지 확인하고 끈다.
   - 변경 후 시스템을 재부팅하고 설치 프로그램을 실행한다.
3. **Process Explorer로 핸들 점검**
   - `Find → Find Handle/DLL`에서 협정보조.exe나 설치 경로를 검색.
   - 보안 프로그램, 쉘 확장 등이 파일 핸들을 붙잡고 있으면 해당 프로세스를 종료하거나 일시적으로 제거.
   - 이후 설치 프로그램을 다시 실행해 락이 풀렸는지 확인.
4. **안전 모드에서 강제 정리**
   - 위 단계로 해결되지 않으면 안전 모드(필요 시 네트워크 포함)로 부팅.
   - 기존 협정보조.exe가 설치된 폴더를 삭제 또는 이름 변경.
   - 안전 모드에서 설치 프로그램을 실행하면 자동 실행 컴포넌트가 동작하지 않아 설치 가능.

## 참고 명령어 예시
```powershell
# 관리자 PowerShell 예시
Get-Service | ?{$_.Name -like '*협정보조*'}
sc stop 협정보조서비스이름
sc config 협정보조서비스이름 start= disabled

# 안전 모드 진입 (Windows 10 기준)
bcdedit /set {default} safeboot minimal
# 재부팅 후 설치, 완료되면
bcdedit /deletevalue {default} safeboot
```

## 추가 요청 시나리오
- 위 방법으로도 ACCESS DENIED가 지속되면 어떤 단계에서 실패했는지 로그/스크린샷을 남겨 공유.
- 설치 경로 권한, 백신 예외 설정도 함께 점검하면 문제 재발을 줄일 수 있다.
