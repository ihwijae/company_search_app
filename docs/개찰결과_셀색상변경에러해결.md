# 엑셀 내보내기 색상 처리 가이드

## 문제 요약
- ExcelJS로 셀 색을 직접 변경할 때, 일부 템플릿에서 **여러 셀이 같은 스타일 객체를 공유**함.
- 이 상태에서 `cell.fill = ...`만 변경하면, **다른 셀까지 함께 색이 바뀌는 현상**이 발생.

## 원인
- 템플릿 셀 스타일이 공유(reference)되기 때문.
- ExcelJS는 기본적으로 셀 스타일을 참조 방식으로 관리한다.

## 해결 방법
- 색상 변경 시, **셀 스타일 전체를 복제해서 적용**한다.
- 예시:
```js
const baseStyle = cell.style ? { ...cell.style } : {};
cell.style = {
  ...baseStyle,
  fill: { type: 'pattern', pattern: 'solid', fgColor: { argb: 'FFFFC000' } },
};
```

## 주의사항
- 스타일을 제거할 때도 동일하게 `cell.style` 복제 후 `fill`을 `pattern: 'none'`으로 설정한다.
- `cell.fill = ...` 형태의 단독 수정은 피한다.
