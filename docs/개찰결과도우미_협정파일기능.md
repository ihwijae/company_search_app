# 개찰결과도우미 - 협정파일 기능 정리

## 기능 개요
협정서 파일의 업체명을 기준으로 DB에서 사업자번호를 조회하고,  
개찰결과 템플릿 파일의 B열(순번 셀)에 색상을 칠해 협정 업체를 시각적으로 구분한다.

## 처리 흐름
1) 협정파일 업로드 → 시트 선택  
2) 협정파일에서 업체명 추출 (대표사 1개만)  
3) 업체명으로 DB 조회 → 사업자번호 확보  
4) 개찰결과 파일 C열 사업자번호와 매칭  
5) 매칭된 행의 B열에 색상 표시  
   - 기본: 파랑 (R0 G176 B240)  
   - 특수 담당자 포함 시: 초록 (R0 G176 B80)

## 업체명 추출 규칙 (LH 기준)
- 시작 행: 5행  
- **A열에 연번이 있는 행만** 처리  
  - A열 값이 비어있으면 종료 조건으로 판단  
  - LH는 빈 연번이 **2줄 연속**이면 종료  
- 업체명은 **C열 1개만** 조회 (협정문자생성과 달리 C/D/E... 전체는 보지 않음)

## 특수 담당자 처리
협정파일 업체명에 다음 문자열이 포함되면 특수 처리:
- 조정 / 서권형 / 구본진

이 경우 해당 업체가 매칭되면 B열 색상을 **초록색**으로 표시.

## 중복 업체 선택 처리
동일 업체명이 여러 건 조회되면 사용자 선택 모달을 띄움.  
**모든 중복 항목을 선택해야만 실행 가능**하도록 강제.

## 기술 메모 (셀 색상 처리)
셀 색상은 ExcelJS 기본 API로 적용하면 기존 스타일(테두리)이 깨지는 문제가 있어  
XML 직접 수정 방식으로 처리.

핵심 포인트:
- `styles.xml`에 fill 스타일(파랑/초록) 추가  
- B열 셀에 해당 스타일 ID만 주입  
- `applyFill="1"` 및 `fillId` 강제 설정  
- 매칭된 행만 업데이트하여 기존 테두리 유지

## 관련 코드 위치
- 협정파일 업체명 추출: `src/view/features/bid-helper/pages/BidResultPage.jsx`
- 매칭 및 셀 색상 적용: `src/main/features/bid-result/applyAgreement.js`
