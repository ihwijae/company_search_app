# 협정보드 공종 덮어쓰기 오류 정리

## 증상
- 공종을 통신/소방으로 조회해도 전기 실적/품질이 들어오는 경우가 발생.
- 업체별로 어떤 곳은 전기, 어떤 곳은 통신 값이 섞여 보임.
- 협정보드에서 후보를 삭제하거나 앱을 재시작해도 문제 지속.

## 원인
1) **협정보드 초기화가 후보 데이터는 비우지 않음**
   - 화면상으로는 초기화된 것처럼 보이지만 후보 리스트가 내부에 남아 있음.
2) **공종 변경 시 후보 데이터가 유지됨**
   - 공종을 바꿔도 기존 후보 데이터가 유지되어 이전 공종 값이 계속 보임.
3) **동일 업체 ID 재사용**
   - 후보 ID가 `search:{사업자번호}` 형태라 공종이 달라도 동일 업체로 취급됨.
   - 공종 변경 후 재조회해도 기존 후보를 덮어쓰지 못하고 남아있는 상태가 발생.

## 해결
### 1) 공종 변경 시 협정보드 상태 초기화
- 공종(fileType) 변경 시 후보/배치/점수 등 공종 의존 데이터를 전부 초기화.
- 이전 공종 데이터가 남아 영향을 주지 않도록 차단.

### 2) 후보 ID에 공종 구분 추가
- 후보 ID를 `search:{fileType}:{사업자번호}` 형태로 변경.
- 동일 업체라도 공종이 다르면 다른 후보로 취급되도록 분리.

### 3) 성능/점수 캐시 제거
- `_agreementPerformance5y`, `_agreementPerformanceScore` 등 캐시 필드 제거/초기화.

## 변경 파일
- `src/view/features/agreements/context/AgreementBoardContext.jsx`

## 참고
- 협정보드의 “초기화” 버튼은 배치/입력값만 리셋하고 후보 리스트는 그대로 유지됨.
- 공종 변경 시 초기화를 추가하면서 문제가 해결됨.
