# 협정보드 2026-01-14 작업 정리

## 공통/UX
- 엑셀 내보내기 로딩: 공용 알림 UI(FeedbackProvider)에 로딩 오버레이 추가.
- 로딩 게이지는 0%부터 반복적으로 채워지는 애니메이션으로 변경.
- 내보내기 수행 중 공통 로딩 표시, 완료 시 자동 해제.

## 엑셀 내보내기/템플릿 공통
- 시트 복사 시 메모(주석)/데이터유효성 말풍선 제거:
  - 셀 note/comment, dataValidation, 워크시트 comments 모델까지 모두 제거.
- 시트 복사 후에도 동일하게 주석 제거 적용.
- 엑셀 파일 열 때 강제 재계산(fullCalcOnLoad=true) 설정:
  - 수동 계산 모드 템플릿에서 #DIV/0! 캐시값이 보이던 문제 해결.

## 한국도로공사(도로공사) 50억 미만 내보내기
- 템플릿 추가: `템플릿/한국도로공사 50억미만.xlsx`
- 템플릿 키: `ex-under50`
- 헤더 위치:
  - 추정가격 D1
  - 기초금액 D2
  - 공고번호/공고명 M1
  - 개찰일 P2
  - 의무지역/의무지분/몇개사 AH1
  - 메모 W2
- 시평액(협정1 대표사/구성원1 기준) 컬럼: AO5/AP5
- 나머지 지분/경영상태/시공실적 등은 기존 발주처와 동일 규칙 사용

## 한국도로공사 템플릿 연결 위치
- main.js: AGREEMENT_TEMPLATE_CONFIGS에 `ex-under50` 설정 추가.
- AgreementBoardWindow: resolveTemplateKey에 `EX + ex-under50` 매핑 추가.

## 엑셀 수식 관련 참고
- AB 열은 수식 셀. 내보내기 후 #DIV/0!가 보였던 원인은 템플릿이 수동 계산 모드였기 때문.
- 강제 재계산 설정으로 해결.

## 파일 변경 목록
- `src/components/FeedbackProvider.jsx` (로딩 오버레이 추가)
- `src/index.css` (로딩 UI 스타일/애니메이션 추가)
- `src/view/features/agreements/components/AgreementBoardWindow.jsx` (공용 로딩 호출)
- `src/main/features/agreements/exportExcel.js` (주석/유효성 제거, 강제 재계산)
- `main.js` (한국도로공사 50억 미만 템플릿 설정)
- `src/view/features/agreements/components/AgreementBoardWindow.jsx` (템플릿 키 매핑)
