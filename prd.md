PRD: 협정 자동화용 엑셀 시트 생성/입력 자동화 (v1)
0) 문서 정보

제품명(가칭): 협정 자동화 도구

대상 플랫폼: Desktop App (Electron + Vite) (구현은 Codex 담당)

버전: v1 (MVP)

1) 배경과 문제

전기/통신/소방 공사 공고 발생 시, 협력사 협정 구성을 반복적으로 수행해야 하며, 적격심사 점수 계산은 엑셀 서식/수식 기반으로 이루어진다.
현재는 입력 과정이 반복적이고 오류 가능성이 있으며, 발주처/금액대에 따라 템플릿 형식이 달라 수작업 부담이 크다.

2) 목표

반복적인 협정 과정의 시간을 줄이고 자동화를 통해 입력 작업을 최소화한다.

최종 산출물은 엑셀 기반이며, 팀장 검토 흐름을 유지한다.

발주처/금액대별 템플릿을 사용하되, 새 파일 생성이 아니라 “기존 협정 엑셀 파일”에 새 시트를 만들어 작업한다.

비목표(명시)

앱에서 점수 로직(엑셀 수식) 재구현 없음.

입찰/제출 시스템 연동 없음.

엑셀 서식/수식 생성(템플릿 자체 제작) 없음. 템플릿은 사용자가 폴더로 제공.

3) 사용자(페르소나)

주 사용자: 협정 담당자(본인 및 팀원)

검토자: 팀장(엑셀 산출물로 검토)

4) 핵심 사용자 시나리오

사용자가 발주처/금액대 선택

공고명/공고번호 입력

공종(전기/통신/소방) 선택

의무지역/의무지분 설정

최대 구성사 수(2~5개) 선택

금액 정보 입력(발주처에 따라 입력 필드가 다름)

앱이 규칙과 셀 매핑(config)에 따라 협정 구성안을 만들고

사용자가 필요 시 협정 구성을 수정(업체 변경/순서/지분 등)

“기존 협정 엑셀 파일”에 새 시트 생성 후 템플릿을 적용하고 값 입력

완료 후 저장된 엑셀 파일을 팀장에게 전달/검토

5) 요구사항
5.1 입력 데이터(사용자 입력)

필수 입력(기본)

공고명

공고번호

공고명+공고번호는 한 세트로 관리

발주처 선택 (드롭다운)

금액대 구간 선택 (드롭다운)

공종 선택: 전기 / 통신 / 소방

의무지역 선택 (드롭다운)

의무지분 입력 (숫자, % 단위)

최대 구성사 수 선택: 2~5개 (정수)

금액 관련 입력(발주처별 조건)

공통 후보 필드:

추정가격

기초금액

투찰금액

시공비율기준금액

발주처별 입력 필수 규칙:

행안부 30억 미만: 추정가격, 기초금액만 입력하면 됨

LH: 추정가격, 기초금액, 시공비율기준금액 입력 필요

국가철도공단: 추정가격, 기초금액만 입력하면 됨

앱은 발주처/금액대 선택에 따라 “필수 필드”를 다르게 렌더링하고 검증한다.

5.2 템플릿/엑셀 처리 방식

사용자가 발주처별, 금액대별 템플릿 엑셀을 폴더에 정리해 제공한다.

앱은 선택된 발주처/금액대에 맞는 템플릿을 로딩한다.

결과는 새 엑셀 파일 생성이 아니라:

사용자가 지정한 “기존 협정 엑셀 파일”에

새 시트(sheet) 를 생성하여

템플릿 구조(서식/수식)를 유지한 상태로 값만 입력한다.

템플릿 적용 방식은 “템플릿 시트를 복사해서 기존 파일에 붙이는 방식”을 기본 전략으로 한다. (구현 세부는 Codex가 결정)

5.3 협정 자동 구성(고정 업체/규칙 기반)

지역/공종별 고정 업체 조합은 사용자가 제공하는 MD를 기반으로 config로 작성한다.

자동 구성은 “입력값(발주처/금액대/공종/의무지역/의무지분/최대 구성사 수)”에 따라 실행된다.

중요한 정책/특이사항

고정업체 조합은 종종 변경된다.

따라서 “앱에 기본값을 고정”으로 박아두지 않는다.

대신 앱 내에서 사용자가 고정업체/규칙을 수정 가능해야 한다.

팀원 배포 및 싱크를 위해:

고정업체정보 가져오기(Import)

고정업체정보 내보내기(Export)
기능을 제공한다.

지분 규칙도 config 기반:

예) “A 업체는 의무지분만 주고 협정해야 함” → 의무지분이 49%면 A에 49% 배정

지분 합은 100%일 필요 없음.

업체 중복은 절대 불가.

5.4 셀 매핑(엑셀에 어느 셀에 무엇을 쓰는지)

“어느 셀에 어떤 데이터를 적는지”는 사용자가 MD로 제공하며 config로 관리한다.

발주처/금액대별로 매핑이 달라질 수 있다.

5.5 오류 처리 / 사용자 알림

데이터가 없거나 오류가 있다면 작업 자체를 중단한다.

UI 팝업(모달/알림창)으로 오류 내용을 명확히 표시한다.

6) 화면/기능 구성 (MVP)
6.1 메인 작업 화면: “협정 시트 생성”

구역 A: 기본 정보

발주처 (드롭다운)

금액대 구간 (드롭다운)

공고명 (텍스트)

공고번호 (텍스트)

공종 (라디오/드롭다운: 전기/통신/소방)

의무지역 (드롭다운)

의무지분 (숫자)

최대 구성사 수 (드롭다운 2~5)

구역 B: 금액 정보(동적)

발주처/금액대 선택에 따라 다음 필드를 노출/필수 지정:

추정가격

기초금액

투찰금액

시공비율기준금액

구역 C: 협정 구성 테이블

대표사 1 + 구성사 N(최대 5) 형태

각 행: 업체명(선택/입력), 지분(%), 비고(옵션)

“자동 구성 적용” 버튼

“업체 추가/삭제”는 최대 구성사 수 범위 내에서만 가능

중복 업체 입력 시 즉시 에러 표시

구역 D: 엑셀 대상 파일 선택 및 실행

“기존 협정 엑셀 파일 선택” (파일 피커)

“새 시트 이름” 자동 생성(기본값) + 사용자 수정 가능

예: [공고번호]_[공종]_[의무지역] 등 (세부 규칙은 구현 시 확정)

“시트 생성 & 값 입력” 실행 버튼

6.2 설정 화면: “Config 관리”

탭 1) 고정업체/규칙 관리 (편집 UI 제공)

탭 2) 셀 매핑 관리 (편집 UI 제공)

Import / Export 버튼

파일 형식: JSON(권장) 또는 MD→JSON 변환(선택)

v1은 “JSON Import/Export”를 기본으로 두고, MD는 참고 문서로만 사용 가능

7) 데이터/Config 스펙 (초안)
7.1 Config 파일 개념 구조

Preset(고정 업체 조합)

Key: 지역 + 공종 (+ 발주처/금액대가 필요하면 확장)

Value: 대표사 후보/구성사 후보/기본 지분 규칙 연결

Rules(지분/제약 규칙)

업체별 규칙(예: 특정 업체는 의무지분만)

중복 금지(전역)

지분합 100% 강제 없음(전역)

TemplateMapping(템플릿 선택 및 셀 매핑)

발주처 + 금액대 구간 → 템플릿 파일/시트 정보

입력 필드 → 엑셀 셀 주소 매핑(예: 공고명 → B2)

실제 JSON 스키마는 Codex가 구현 편의를 위해 확정한다. 단, 위 3개 영역은 반드시 분리 가능해야 한다.

8) 검증 규칙 (Validation)

필수 입력 검증

공고명, 공고번호 필수

발주처, 금액대 구간, 공종, 의무지역, 의무지분, 최대 구성사 수 필수

발주처에 따른 금액 필수값 검증(행안부/LH/국가철도공단 규칙 적용)

협정 구성 검증

업체 중복: 즉시 오류(저장/실행 불가)

구성사 수: 사용자가 선택한 최대 수 초과 불가

지분: 숫자 형식 검증(0 이상, 상한은 제한하지 않음)

지분 합 100% 강제하지 않음

템플릿/매핑 검증

선택한 발주처/금액대에 맞는 템플릿이 없으면 실행 불가

필수 셀 매핑 누락 시 실행 불가

9) 오류 메시지(예시)

“선택한 발주처/금액대에 해당하는 템플릿을 찾을 수 없습니다.”

“셀 매핑이 누락되어 시트를 생성할 수 없습니다: [공고번호 셀]”

“업체가 중복되었습니다: [업체명]. 중복 업체는 허용되지 않습니다.”

“필수 금액 정보가 누락되었습니다: [시공비율기준금액] (LH 템플릿)”

“기존 협정 엑셀 파일을 선택해주세요.”

10) 수용 기준(Acceptance Criteria)

기능

사용자가 발주처/금액대/공종/의무조건/최대 구성사 수/금액 정보를 입력할 수 있다.

입력값에 따라 필요한 금액 필드가 동적으로 표시되고, 필수 검증이 동작한다.

Config 기반으로 협정 구성 자동 생성이 가능하다.

사용자가 협정 구성(업체/지분)을 앱 내에서 수정할 수 있다.

업체 중복이 발생하면 실행이 차단되고 팝업 오류가 표시된다.

사용자가 지정한 기존 협정 엑셀 파일에 새 시트가 생성되고, 템플릿 구조 유지 + 값 입력이 완료된다.

Config Import/Export가 가능하다(팀원 간 공유 목적).

품질

에러 발생 시, 원인과 해결 힌트를 포함한 팝업이 뜬다.

잘못된 입력 상태에서 “시트 생성 & 값 입력” 버튼은 비활성화 또는 실행 시 차단된다.



11) 테스트 케이스(대표)

발주처별 필수 입력

행안부 30억 미만 선택 → 추정가격/기초금액만 필수, 시공비율기준금액 없어도 통과

LH 선택 → 시공비율기준금액 누락 시 차단

국가철도공단 선택 → 추정가격/기초금액만 필수

중복 업체

대표사와 구성사에 동일 업체 입력 → 즉시 차단 + 오류 팝업

최대 구성사 수

최대 2개사 선택 후 구성사 3개 추가 시도 → 차단

템플릿 누락

발주처/금액대 조합에 템플릿 파일이 없을 때 → 실행 불가 + 오류

매핑 누락

공고번호 셀 매핑이 없는 상태에서 실행 → 실행 불가 + 오류





12) 오픈 이슈 / 추후 결정 필요(지금은 가정으로 둠)

PRD에는 “필요하면 Codex가 물어볼 포인트”를 최소로 남긴다.

“기존 협정 엑셀 파일”의 기준: 항상 동일 파일 1개에 계속 시트를 쌓는지, 공고마다 파일이 다른지

새 시트 이름 규칙(중복 시 suffix 붙이기 등)

템플릿 적용 방식: 템플릿 파일에서 시트 복사 vs 템플릿 시트를 통째로 Import

config 편집 UI 범위(v1에서 최소 편집만 할지, 완전 편집까지 할지)